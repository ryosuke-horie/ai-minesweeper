# 「AIにネタバレされるマインスイーパー」開発仕様書

## 1. コンセプト 🎯

このゲームの目的は、従来のマインスイーパーを完全に再現することではない。**「論理的に確定できる面倒な作業はAIが全て行い、人間は運が絡む究極の選択だけを迫られる」**という体験をユーザーに提供することにある。

**目指すバイブ（雰囲気）:**
* **スピーディー & 小気味良い:** AIの思考時間はゼロに感じられるほど一瞬。
* **理不尽 & 皮肉:** プレイヤーは最も面白くて最もリスクのある部分だけを担当させられる。
* **ミニマル:** 余計な装飾はなく、ゲームの本質的な体験に集中させる。

---

## 2. 機能リスト 📝

実装すべき機能を大きく3つのコンポーネントに分けて整理します。

### A. ゲームコア機能 (盤面の管理)
* **盤面生成機能:**
    * 指定されたサイズ（縦・横）と地雷の数に応じて、ゲーム盤面を生成する。
    * 地雷の位置はランダムに配置する。
* **ゲーム状態管理機能:**
    * ゲームの状態（プレイ中, クリア, ゲームオーバー）を管理する。
    * クリア条件（地雷以外のマスが全て開かれた）を判定する。
    * ゲームオーバー条件（地雷のマスを開いた）を判定する。
* **マス操作機能:**
    * 指定されたマスを「開く」。
    * 開いたマスが0だった場合、隣接するマスを再帰的に開く（これは従来のマインスイーパーと同じ）。

### B. AIソルバー機能 (ネタバレ担当)
* **確定的安全マス発見機能:**
    * 盤面全体をスキャンし、「このマスは絶対に安全だ」と論理的に100%断定できるマスを全てリストアップする。
    * （例：数字が`1`のマスに隣接する未開封マスが1つだけで、そこに旗が立っている場合、残りの未開封マスは全て安全）
* **確定的地雷マス発見機能:**
    * 盤面全体をスキャンし、「このマスは絶対に地雷だ」と論理的に100%断定できるマスに（内部的に）目印をつける。
    * （例：数字が`1`のマスに隣接する未開封マスが1つしかない場合、そのマスは地雷で確定）
* **連続解決機能:**
    * 上記2つの機能を使って、安全なマスを開く→その結果を基に、さらに安全なマスや地雷マスを特定する、というプロセスを「これ以上論理的に進めなくなるまで」繰り返す。

### C. UI/UX機能 (ユーザーとの接点)
* **盤面描画機能:**
    * ゲームコアの盤面情報に基づき、マスをグリッド状に表示する。
    * マスの状態（未開封, 開封済み, 旗）を視覚的に表現する。
* **ゲーム開始/リセット機能:**
    * 難易度（初級・中級・上級など）を選択し、ゲームを開始できるボタン。
    * ゲームを最初からやり直せるリセットボタン。
* **ユーザー入力機能:**
    * プレイヤーが未開封のマスをクリックする操作を受け付ける。
* **状態表示機能:**
    * ゲームの状態（クリア！, ゲームオーバー…）を分かりやすく表示する。
    * （任意）残り地雷数や経過時間を表示する。

---

## 3. 機能の関係性とゲームフロー 🔄

ユーザー体験のフローは以下の通りです。

1. **【ユーザー】** 難易度を選択し、ゲームを開始する。
2. **【システム】** `ゲームコア`が盤面を生成し、`UI`に表示する。
3. **【ユーザー】** 最初の1マスをクリックする。
    * このクリックでゲームオーバーになることはないようにする（初回クリック保証）。
4. **【システム (AIターン)】**
    * `AIソルバー`が現在の盤面を分析する。
    * 論理的に確定できる全ての安全なマスを開く。この処理は**一瞬**で行われ、途中経過は見せない。
    * `UI`はAIが解決した後の最終的な盤面を一度に更新する。
5. **【システム (人間ターン)】**
    * `AIソルバー`が「これ以上は論理的に解けない」と判断したら、処理を停止する。
    * **ゲームがユーザーに操作を委ねる。** UIはクリック待ちの状態になる。
6. **【ユーザー】** 運を天に任せ、いずれかのマスをクリックする。
    * **地雷だった場合 →** 「ゲームオーバー」と表示され、フロー終了。
    * **安全なマスだった場合 →** そのマスが開き、**手順4の【システム (AIターン)】に戻る。**
7. 上記4〜6のループを繰り返し、地雷以外のマスが全て開かれたら「クリア」と表示され、フロー終了。

---

## 4. 実装の成功基準 (Definition of Done) ✅

以下の状態になったら、このプロジェクトは「成功」と見なせます。

### 最低限の成功ライン (Must-have):
- [ ] ゲームを開始し、ユーザーが最初のマスをクリックできる。
- [ ] クリック後、AIが連鎖的に安全なマスを**一瞬で**開封する。
- [ ] 論理的に解き進められなくなると、AIの自動開封が**正しく停止**し、ユーザーの入力待ちになる。
- [ ] ユーザーが次のマスを選択すると、ゲームが適切に進行する（ゲームオーバー or AIターン再開）。
- [ ] ゲームのクリア判定とゲームオーバー判定が正しく機能する。

### 目指したいゴール (Nice-to-have):
- [ ] 初級・中級・上級の3段階の難易度が実装されている。
- [ ] 経過時間と残り地雷数のカウンターが表示されている。
- [ ] AIの処理で画面がチラつかず、スムーズに盤面が更新される。
- [ ] 見た目がクリーンで、原作の「vibe」を感じさせるデザインになっている。